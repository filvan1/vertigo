(()=>{"use strict";var e;!function(e){e[e.NORMAL=0]="NORMAL",e[e.HIGH=1]="HIGH"}(e||(e={}));var n,t,r=function(n,t,r,i){void 0===i&&(i=e.NORMAL),this.identifier=n,this.sender=t,this.payload=r,this.priority=i},i=function(){function n(){}return n.addSubscription=function(e,t){var r=n._subscriberMap[e];void 0===r&&(n._subscriberMap[e]=[],r=[]),-1!==r.indexOf(t)?console.warn(t+" already exists in sub map with key "+e):n._subscriberMap[e].push(t)},n.removeSubscription=function(e,t){var r=n._subscriberMap[e];if(void 0!==r){var i=r.indexOf(t);-1!==i&&n._subscriberMap[e].splice(i,1)}else console.warn(t+" not subscribed to "+e)},n.post=function(t){var r=n._subscriberMap[t.identifier];if(void 0!==r)for(var i=0,o=r;i<o.length;i++){var a=o[i];t.priority==e.HIGH?a.receiveMessage(t):n._messageQueue.push(t)}else console.log("Message "+t+" not posted: No subscribers ")},n.update=function(){if(0!==n._messageQueue.length)for(var e=Math.min(n._normalMessageCapacity,n._messageQueue.length),t=0;t<e;t++)for(var r=n._messageQueue.pop(),i=0,o=this._subscriberMap[r.identifier];i<o.length;i++)o[i].receiveMessage(r)},n._subscriberMap={},n._normalMessageCapacity=10,n._messageQueue=[],n}();const o=function(){function e(e){if(null==(t=e))throw new Error("Canvas initialization failed!");if(void 0===(n=t.getContext("webgl2")))throw new Error("Unable to initiaze WebGL");i.addSubscription("CLICK",this)}return e.prototype.receiveMessage=function(e){console.log("Renderer received "+e.identifier)},Object.defineProperty(e.prototype,"getRenderer",{get:function(){return this},enumerable:!1,configurable:!0}),e.prototype.init=function(){var r=e.createShader(n,n.VERTEX_SHADER,"#version 300 es\n \n// an attribute is an input (in) to a vertex shader.\n// It will receive data from a buffer\nin vec4 a_position;\n\nuniform mat4 u_projection;\nuniform mat4 u_translation;\n\n// all shaders have a main function\nvoid main() {\n\n  // gl_Position is a special variable a vertex shader\n  // is responsible for setting\n  gl_Position = a_position;\n}\n"),i=e.createShader(n,n.FRAGMENT_SHADER,'#version 300 es\n \n// fragment shaders don\'t have a default precision so we need\n// to pick one. highp is a good default. It means "high precision"\nprecision highp float;\n \n// we need to declare an output for the fragment shader\nout vec4 outColor;\n \nvoid main() {\n  // Just set the output to a constant reddish-purple\n  outColor = vec4(1, 0, 0.5, 1);\n}\n'),o=e.createProgram(n,r,i);if(n.useProgram(o),null==o)throw new Error("Program creation failed!");var a=n.getAttribLocation(o,"a_position"),s=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,s),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,0,0,.5,.7,0]),n.STATIC_DRAW);var u=n.createVertexArray();n.bindVertexArray(u),n.enableVertexAttribArray(a);var c=n.FLOAT,d=0;n.vertexAttribPointer(a,2,c,!1,0,d),e.resizeCanvasToDisplaySize(t),n.viewport(0,0,n.canvas.width,n.canvas.height),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT);var f=n.TRIANGLES;d=0,n.drawArrays(f,d,3)},e.createShader=function(e,n,t){var r=e.createShader(n);if(e.shaderSource(r,t),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))return r;console.log(e.getShaderInfoLog(r)),e.deleteShader(r)},e.createProgram=function(e,n,t){var r=e.createProgram();if(e.attachShader(r,n),e.attachShader(r,t),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS))return r;console.log(e.getProgramInfoLog(r)),e.deleteProgram(r)},e.resizeCanvasToDisplaySize=function(e){var n=e.clientWidth,t=e.clientHeight;(e.width!==n||e.height!==t)&&(e.width=n,e.height=t)},e}(),a=function(){function e(e,n){this.targetElement=e,this.renderer=n}return e.prototype.receiveMessage=function(e){},e.prototype.update=function(){},e.prototype.onKeyDown=function(e){"ArrowUp"===e.key&&console.log("UP!")},e.prototype.initInputEvents=function(){var e=this;this.targetElement.onmousemove=function(e){},this.targetElement.onmousedown=function(n){console.log("X:"+n.pageX+" Y:"+n.pageY),i.post(new r("CLICK",e))}},e}();var s=function(){function e(e){if(void 0===e&&(e="vertigoCanvas"),this._canvas=document.getElementById(e),void 0===this._canvas)throw new Error("FATAL: Cannot find destination canvas element with name:"+e)}return e.prototype.initialize=function(){this._renderer=new o(this._canvas),this._renderer.init(),new a(this._canvas,this._renderer).initInputEvents(),this.run()},e.sendInputMessage=function(e){},e.prototype.run=function(){var e=function(){i.update(),window.requestAnimationFrame(e)};window.requestAnimationFrame(e)},e}();window.onload=function(){(new s).initialize()}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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c0JBQXNCRixJQUc5QkMsT0FBT0Msc0JBQXNCRixJQUsvQixFQTFDQSxHQ0pBQyxPQUFPRSxPQUFTLFlBQ00sSUFBSUMsR0FDVlIsZSIsInNvdXJjZXMiOlsid2VicGFjazovL3ZlcnRpZ28vLi9lbmdpbmUvc3JjL21lc3NhZ2UvbWVzc2FnZS50cyIsIndlYnBhY2s6Ly92ZXJ0aWdvLy4vZW5naW5lL3NyYy9yZW5kZXJlci9yZW5kZXJlci50cyIsIndlYnBhY2s6Ly92ZXJ0aWdvLy4vZW5naW5lL3NyYy9tZXNzYWdlL21lc3NhZ2VCdXMudHMiLCJ3ZWJwYWNrOi8vdmVydGlnby8uL2VuZ2luZS9zcmMvcmVuZGVyZXIvc2hhZGVycy92ZXJ0ZXguZ2xzbCIsIndlYnBhY2s6Ly92ZXJ0aWdvLy4vZW5naW5lL3NyYy9yZW5kZXJlci9zaGFkZXJzL2ZyYWdtZW50Lmdsc2wiLCJ3ZWJwYWNrOi8vdmVydGlnby8uL2VuZ2luZS9zcmMvaW5wdXQudHMiLCJ3ZWJwYWNrOi8vdmVydGlnby8uL2VuZ2luZS9zcmMvZW5naW5lLnRzIiwid2VicGFjazovL3ZlcnRpZ28vLi9lbmdpbmUvc3JjL2FwcC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmV4cG9ydCBlbnVtIE1lc3NhZ2VQcmlvcml0eXtcbiAgICBOT1JNQUwsXG4gICAgSElHSFxufVxuXG5leHBvcnQgY2xhc3MgTWVzc2FnZXtcblxuICAgIFxuXG4gICAgcHVibGljIGlkZW50aWZpZXI6c3RyaW5nO1xuICAgIHB1YmxpYyBwYXlsb2FkOmFueTtcbiAgICBwdWJsaWMgcHJpb3JpdHk6TWVzc2FnZVByaW9yaXR5O1xuICAgIHB1YmxpYyBzZW5kZXI6YW55O1xuICAgIFxuXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKGlkZW50aWZpZXI6c3RyaW5nLHNlbmRlcjphbnkscGF5bG9hZD86YW55LHByaW9yaXR5PU1lc3NhZ2VQcmlvcml0eS5OT1JNQUwpe1xuICAgICAgICB0aGlzLmlkZW50aWZpZXI9aWRlbnRpZmllcjtcbiAgICAgICAgdGhpcy5zZW5kZXI9c2VuZGVyO1xuICAgICAgICB0aGlzLnBheWxvYWQ9cGF5bG9hZDtcbiAgICAgICAgdGhpcy5wcmlvcml0eT1wcmlvcml0eTtcbiAgICB9XG5cbn0iLCJpbXBvcnQgVmVydGV4U2hhZGVyU291cmNlIGZyb20gXCIuL3NoYWRlcnMvdmVydGV4Lmdsc2xcIjtcbmltcG9ydCBGcmFnbWVudFNoYWRlclNvdXJjZSBmcm9tIFwiLi9zaGFkZXJzL2ZyYWdtZW50Lmdsc2xcIjtcbmltcG9ydCB7IElNZXNzYWdlU3Vic2NyaWJlciB9IGZyb20gXCIuLi9tZXNzYWdlL0lNZXNzYWdlU3Vic2NyaWJlclwiO1xuaW1wb3J0IHsgTWVzc2FnZSB9IGZyb20gXCIuLi9tZXNzYWdlL21lc3NhZ2VcIjtcbmltcG9ydCB7IE1lc3NhZ2VCdXMgfSBmcm9tIFwiLi4vbWVzc2FnZS9tZXNzYWdlQnVzXCI7XG5cbmV4cG9ydCB2YXIgZ2w6IFdlYkdMMlJlbmRlcmluZ0NvbnRleHQ7XG52YXIgX2NhbnZhczogSFRNTENhbnZhc0VsZW1lbnQ7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlbmRlcmVyIGltcGxlbWVudHMgSU1lc3NhZ2VTdWJzY3JpYmVye1xuXHRjb25zdHJ1Y3Rvcih0YXJnZXQ6IEhUTUxDYW52YXNFbGVtZW50KSB7XG5cdFx0X2NhbnZhcyA9IHRhcmdldDtcblxuICAgICAgICBpZiAoX2NhbnZhcyA9PSBudWxsKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJDYW52YXMgaW5pdGlhbGl6YXRpb24gZmFpbGVkIVwiKTtcblx0XHR9XG5cblx0XHRnbCA9IF9jYW52YXMuZ2V0Q29udGV4dChcIndlYmdsMlwiKTtcblx0XHRpZiAoZ2wgPT09IHVuZGVmaW5lZCkgdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIGluaXRpYXplIFdlYkdMXCIpO1xuXHRcdE1lc3NhZ2VCdXMuYWRkU3Vic2NyaXB0aW9uKFwiQ0xJQ0tcIix0aGlzKTtcblx0fVxuXG5cdHJlY2VpdmVNZXNzYWdlKG1lc3NhZ2U6IE1lc3NhZ2UpOiB2b2lkIHtcblx0XHRjb25zb2xlLmxvZyhcIlJlbmRlcmVyIHJlY2VpdmVkIFwiK21lc3NhZ2UuaWRlbnRpZmllcik7XG5cdH1cblxuXHQgXG5cdHB1YmxpYyBnZXQgZ2V0UmVuZGVyZXIoKSA6IFJlbmRlcmVyIHtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXHRcblxuXHRpbml0KCkge1xuXG5cdFx0dmFyIHZlcnQgPSBSZW5kZXJlci5jcmVhdGVTaGFkZXIoZ2wsIGdsLlZFUlRFWF9TSEFERVIsIFZlcnRleFNoYWRlclNvdXJjZSk7XG5cdFx0dmFyIGZyYWcgPSBSZW5kZXJlci5jcmVhdGVTaGFkZXIoZ2wsIGdsLkZSQUdNRU5UX1NIQURFUiwgRnJhZ21lbnRTaGFkZXJTb3VyY2UpO1xuXG5cdFx0dmFyIHByb2dyYW0gPSBSZW5kZXJlci5jcmVhdGVQcm9ncmFtKGdsLCB2ZXJ0LCBmcmFnKTtcbiAgICAgICAgLy9UZWxsIFdlYkdMIHRvIHVzZSBvdXIgcHJvZ3JhbVxuXHRcdGdsLnVzZVByb2dyYW0ocHJvZ3JhbSk7XG5cblx0XHRpZiAocHJvZ3JhbSA9PSBudWxsKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJQcm9ncmFtIGNyZWF0aW9uIGZhaWxlZCFcIik7XG5cdFx0fVxuXHRcdFxuXG5cdFx0Ly9Mb29rIHVwIHdoZXJlIG91ciBjb21waWxlZCBhdHRyaWJ1dGUgZW5kZWQgdXBcblx0XHR2YXIgcG9zaXRpb25BdHRyaWJ1dGVMb2NhdGlvbiA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKHByb2dyYW0sIFwiYV9wb3NpdGlvblwiKTtcblxuXHRcdC8vQ3JlYXRlIGEgYnVmZmVyIGFuZCB0ZWxsIFdlYkdMIHdoYXQgaXQncyBmb3Jcblx0XHR2YXIgcG9zaXRpb25CdWZmZXIgPSBnbC5jcmVhdGVCdWZmZXIoKTtcblx0XHRnbC5iaW5kQnVmZmVyKGdsLkFSUkFZX0JVRkZFUiwgcG9zaXRpb25CdWZmZXIpO1xuXG5cdFx0dmFyIHBvc2l0aW9ucyA9IFswLCAwLCAwLCAwLjUsIDAuNywgMF07XG5cdFx0Ly9CaW5kIGRhdGEgdG8gdGhlIGJ1ZmZlciBhbmQgdGVsbCBpdCB0aGF0IHRoZSBkYXRhIHdvbid0IGNoYW5nZSB0aGF0IG11Y2guXG5cdFx0Z2wuYnVmZmVyRGF0YShnbC5BUlJBWV9CVUZGRVIsIG5ldyBGbG9hdDMyQXJyYXkocG9zaXRpb25zKSwgZ2wuU1RBVElDX0RSQVcpO1xuXG5cdFx0Ly9DcmVhdGUgYW5kIGJpbmQgdmVydGV4IGxpc3QsIG9oIHllYWghXG5cdFx0dmFyIHZhbyA9IGdsLmNyZWF0ZVZlcnRleEFycmF5KCk7XG5cdFx0Z2wuYmluZFZlcnRleEFycmF5KHZhbyk7XG5cdFx0Ly9cIlR1cm4gb25cIiB0aGUgYXR0cmlidXRlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGUgZGF0YS4gSWYgd2UgZG9uJ3QgZG8gdGhpcyB0aGUgYXR0cmlidXRlIHdpbGwgYmUgYSBjb25zdGFudFxuXHRcdGdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KHBvc2l0aW9uQXR0cmlidXRlTG9jYXRpb24pO1xuXG5cdFx0Ly9UZWxsIFdlYkdMIGhvdyB0byBnZXQgdGhlIGRhdGEgb3V0LiBCaW5kcyBjdXJyZW50IEFSUkFZX0JVRkZFUiB0byB0aGUgYXR0cmlidXRlLCBzbyBub3cgd2UgY2FuIGJpbmQgd2hhdGV2ZXJcblx0XHR2YXIgc2l6ZSA9IDI7IC8vIDIgY29tcG9uZW50cyBwZXIgaXRlcmF0aW9uXG5cdFx0dmFyIHR5cGUgPSBnbC5GTE9BVDsgLy8gdGhlIGRhdGEgaXMgMzJiaXQgZmxvYXRzXG5cdFx0dmFyIG5vcm1hbGl6ZSA9IGZhbHNlOyAvLyBkb24ndCBub3JtYWxpemUgdGhlIGRhdGFcblx0XHR2YXIgc3RyaWRlID0gMDsgLy8gMCA9IG1vdmUgZm9yd2FyZCBzaXplICogc2l6ZW9mKHR5cGUpIGVhY2ggaXRlcmF0aW9uIHRvIGdldCB0aGUgbmV4dCBwb3NpdGlvblxuXHRcdHZhciBvZmZzZXQgPSAwOyAvLyBzdGFydCBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBidWZmZXJcblxuXHRcdC8vVGhpcyBiaW5kcyBjdXJyZW50IEFSUkFZX0JVRkZFUiB0byB0aGUgdmVydGV4IGF0dHJpYnV0ZSwgc28gbm93IHRoZSBBUlJBWV9CVUZGRVIgY2FuIGJlIGZyZWVseSBjaGFuZ2VkIHdpdGhvdXQgaW1wYWN0aW5nIGl0LlxuXHRcdGdsLnZlcnRleEF0dHJpYlBvaW50ZXIoXG5cdFx0XHRwb3NpdGlvbkF0dHJpYnV0ZUxvY2F0aW9uLFxuXHRcdFx0c2l6ZSxcblx0XHRcdHR5cGUsXG5cdFx0XHRub3JtYWxpemUsXG5cdFx0XHRzdHJpZGUsXG5cdFx0XHRvZmZzZXRcblx0XHQpO1xuXG5cdFx0Ly9SZXNpemUgdGhlIEdMIENhbnZhcyB0byB0aGUgc2l6ZSBkZXRlcm1pbmVkIGJ5IENTU1xuXHRcdFJlbmRlcmVyLnJlc2l6ZUNhbnZhc1RvRGlzcGxheVNpemUoX2NhbnZhcyk7XG5cdFx0Ly9UZWxsIFdlYkdMIHRoYXQgdGhlIHZpZXdwb3J0IGhhcyBjaGFuZ2VkIVxuXHRcdGdsLnZpZXdwb3J0KDAsIDAsIGdsLmNhbnZhcy53aWR0aCwgZ2wuY2FudmFzLmhlaWdodCk7XG5cblx0XHQvL1NjcnViIHRoZSBjYW52YXNcblx0XHRnbC5jbGVhckNvbG9yKDAsIDAsIDAsIDApO1xuXHRcdGdsLmNsZWFyKGdsLkNPTE9SX0JVRkZFUl9CSVQpO1xuXG5cdFx0XG5cblx0XHR2YXIgcHJpbWl0aXZlVHlwZSA9IGdsLlRSSUFOR0xFUztcblx0XHR2YXIgb2Zmc2V0ID0gMDtcblx0XHR2YXIgY291bnQgPSAzO1xuXG5cdFx0LypJdGVyYXRlcyB0aHJvdWdoIHRoZSBhcnJheSBhbmQgZHJhd3MgdGhlbSBldmVuIGlmIHRoZSB2ZXJ0aWNlcyBoYXZlIGJlZW4gbG9hZGVkIGJlZm9yZS4gXG4gICAgICBnbC5kcmF3RWxlbWVudHMgaXMgcXVpY2tlciBpbiBtYW55IGNhc2VzLCBzaW5jZSBpdCBjYWNoZXMgcmVwZWF0ZWQgdmVydGljZXMgaW4gdGhlIGdwdS4gXG4gICAgICAqL1xuXHRcdGdsLmRyYXdBcnJheXMocHJpbWl0aXZlVHlwZSwgb2Zmc2V0LCBjb3VudCk7XG5cbiAgICAgICAgXG5cblx0fVxuXG5cdC8vI3JlZ2lvbiBIZWxwZXIgZnVuY3Rpb25zIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0LyoqXG5cdCAqIENvbXBpbGVzIGEgc2hhZGVyIGFuZCByZXR1cm5zIGl0LiBJZiBjb21waWxhdGlvbiBmYWlscywgbG9nIHRoZSBzaGFkZXIgY29kZSBhbmQgZGVsZXRlIHRoZSBzaGFkZXIgZnJvbSB0aGUgY29udGV4dC5cblx0ICogQHBhcmFtIGdsIFdlYkdMIENvbnRleHRcblx0ICogQHBhcmFtIHR5cGUgU2hhZGVyIFR5cGVcblx0ICogQHBhcmFtIHNvdXJjZSBTaGFkZXIgc291cmNlIGNvZGVcblx0ICovXG5cdHN0YXRpYyBjcmVhdGVTaGFkZXIoXG5cdFx0Z2w6IFdlYkdMMlJlbmRlcmluZ0NvbnRleHQsXG5cdFx0dHlwZTogbnVtYmVyLFxuXHRcdHNvdXJjZTogc3RyaW5nXG5cdCkge1xuXHRcdHZhciBzaGFkZXIgPSBnbC5jcmVhdGVTaGFkZXIodHlwZSk7XG5cdFx0Z2wuc2hhZGVyU291cmNlKHNoYWRlciwgc291cmNlKTtcblx0XHRnbC5jb21waWxlU2hhZGVyKHNoYWRlcik7XG5cdFx0dmFyIHN1Y2Nlc3MgPSBnbC5nZXRTaGFkZXJQYXJhbWV0ZXIoc2hhZGVyLCBnbC5DT01QSUxFX1NUQVRVUyk7XG5cdFx0aWYgKHN1Y2Nlc3MpIHtcblx0XHRcdHJldHVybiBzaGFkZXI7XG5cdFx0fVxuXG5cdFx0Y29uc29sZS5sb2coZ2wuZ2V0U2hhZGVySW5mb0xvZyhzaGFkZXIpKTtcblx0XHRnbC5kZWxldGVTaGFkZXIoc2hhZGVyKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBMaW5rcyB0aGUgY29tcGlsZWQgc2hhZGVycyB3aXRoIHRoZSBHTCBjb250ZXh0IGFuZCBjcmVhdGVzIGEgcHJvZ3JhbSBvbiB0aGUgR1BVLlxuXHQgKiBAcGFyYW0gZ2wgV2ViR0wgQ29udGV4dFxuXHQgKiBAcGFyYW0gdmVydGV4U2hhZGVyIFZlcnRleCBzaGFkZXJcblx0ICogQHBhcmFtIGZyYWdtZW50U2hhZGVyIEZyYWdtZW50IHNoYWRlclxuXHQgKi9cblx0c3RhdGljIGNyZWF0ZVByb2dyYW0oXG5cdFx0Z2w6IFdlYkdMMlJlbmRlcmluZ0NvbnRleHQsXG5cdFx0dmVydGV4U2hhZGVyOiBXZWJHTFNoYWRlcixcblx0XHRmcmFnbWVudFNoYWRlcjogV2ViR0xTaGFkZXJcblx0KSB7XG5cdFx0dmFyIHByb2dyYW0gPSBnbC5jcmVhdGVQcm9ncmFtKCk7XG5cdFx0Z2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIHZlcnRleFNoYWRlcik7XG5cdFx0Z2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIGZyYWdtZW50U2hhZGVyKTtcblx0XHRnbC5saW5rUHJvZ3JhbShwcm9ncmFtKTtcblx0XHR2YXIgc3VjY2VzcyA9IGdsLmdldFByb2dyYW1QYXJhbWV0ZXIocHJvZ3JhbSwgZ2wuTElOS19TVEFUVVMpO1xuXHRcdGlmIChzdWNjZXNzKSB7XG5cdFx0XHRyZXR1cm4gcHJvZ3JhbTtcblx0XHR9XG5cblx0XHRjb25zb2xlLmxvZyhnbC5nZXRQcm9ncmFtSW5mb0xvZyhwcm9ncmFtKSk7XG5cdFx0Z2wuZGVsZXRlUHJvZ3JhbShwcm9ncmFtKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZXNpemVzIGRpc3BsYXkgdG8gSFRNTCBjYW52YXMgc2l6ZSBzZXQgYnkgQ1NTXG5cdCAqIEBwYXJhbSBjYW52YXMgQ2FudmFzIEhUTUwgZWxlbWVudFxuXHQgKi9cblx0c3RhdGljIHJlc2l6ZUNhbnZhc1RvRGlzcGxheVNpemUoY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCkge1xuXHRcdC8vIExvb2t1cCB0aGUgc2l6ZSB0aGUgYnJvd3NlciBpcyBkaXNwbGF5aW5nIHRoZSBjYW52YXMgaW4gQ1NTIHBpeGVscy5cblx0XHRjb25zdCBkaXNwbGF5V2lkdGggPSBjYW52YXMuY2xpZW50V2lkdGg7XG5cdFx0Y29uc3QgZGlzcGxheUhlaWdodCA9IGNhbnZhcy5jbGllbnRIZWlnaHQ7XG5cdFx0Ly8gQ2hlY2sgaWYgdGhlIGNhbnZhcyBpcyBub3QgdGhlIHNhbWUgc2l6ZS5cblx0XHRjb25zdCBuZWVkUmVzaXplID1cblx0XHRcdGNhbnZhcy53aWR0aCAhPT0gZGlzcGxheVdpZHRoIHx8IGNhbnZhcy5oZWlnaHQgIT09IGRpc3BsYXlIZWlnaHQ7XG5cblx0XHRpZiAobmVlZFJlc2l6ZSkge1xuXHRcdFx0Ly8gTWFrZSB0aGUgY2FudmFzIHRoZSBzYW1lIHNpemVcblx0XHRcdGNhbnZhcy53aWR0aCA9IGRpc3BsYXlXaWR0aDtcblx0XHRcdGNhbnZhcy5oZWlnaHQgPSBkaXNwbGF5SGVpZ2h0O1xuXHRcdH1cblx0fVxuXHQvLyNlbmRyZWdpb25cbn1cbiIsImltcG9ydCB7IElNZXNzYWdlU3Vic2NyaWJlciB9IGZyb20gXCIuL0lNZXNzYWdlU3Vic2NyaWJlclwiO1xuaW1wb3J0IHsgTWVzc2FnZSwgTWVzc2FnZVByaW9yaXR5IH0gZnJvbSBcIi4vbWVzc2FnZVwiO1xuXG5leHBvcnQgY2xhc3MgTWVzc2FnZUJ1cyB7XG5cdHByaXZhdGUgc3RhdGljIF9zdWJzY3JpYmVyTWFwOiB7W2lkZW50aWZpZXI6IHN0cmluZ106IElNZXNzYWdlU3Vic2NyaWJlcltdIH0gPSB7fTtcblx0cHJpdmF0ZSBzdGF0aWMgX25vcm1hbE1lc3NhZ2VDYXBhY2l0eSA9IDEwO1xuXHRwcml2YXRlIHN0YXRpYyBfbWVzc2FnZVF1ZXVlOiBNZXNzYWdlW10gPSBbXTtcblxuXHRwcml2YXRlIGNvbnN0cnVjdG9yKCkge31cblxuICAgIHB1YmxpYyBzdGF0aWMgYWRkU3Vic2NyaXB0aW9uKGlkZW50aWZpZXI6c3RyaW5nLHN1YnNjcmliZXI6SU1lc3NhZ2VTdWJzY3JpYmVyKTp2b2lke1xuICAgICAgICBsZXQgY3VycmVudD1NZXNzYWdlQnVzLl9zdWJzY3JpYmVyTWFwW2lkZW50aWZpZXJdO1xuICAgICAgICBpZihjdXJyZW50ID09PSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgTWVzc2FnZUJ1cy5fc3Vic2NyaWJlck1hcFtpZGVudGlmaWVyXT1bXTtcbiAgICAgICAgICAgIGN1cnJlbnQ9W107XG4gICAgICAgIH1cblxuICAgICAgICBpZihjdXJyZW50LmluZGV4T2Yoc3Vic2NyaWJlcikhPT0tMSl7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oc3Vic2NyaWJlcitcIiBhbHJlYWR5IGV4aXN0cyBpbiBzdWIgbWFwIHdpdGgga2V5IFwiK2lkZW50aWZpZXIpO1xuICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICBNZXNzYWdlQnVzLl9zdWJzY3JpYmVyTWFwW2lkZW50aWZpZXJdLnB1c2goc3Vic2NyaWJlcik7XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIHB1YmxpYyBzdGF0aWMgcmVtb3ZlU3Vic2NyaXB0aW9uKGlkZW50aWZpZXI6c3RyaW5nLHN1YnNjcmliZXI6SU1lc3NhZ2VTdWJzY3JpYmVyKTp2b2lke1xuICAgICAgICBsZXQgY3VycmVudD1NZXNzYWdlQnVzLl9zdWJzY3JpYmVyTWFwW2lkZW50aWZpZXJdO1xuICAgICAgICBpZihjdXJyZW50ID09PXVuZGVmaW5lZCl7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oc3Vic2NyaWJlcitcIiBub3Qgc3Vic2NyaWJlZCB0byBcIitpZGVudGlmaWVyKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBpbmRleD1jdXJyZW50LmluZGV4T2Yoc3Vic2NyaWJlcik7XG4gICAgICAgIGlmKGluZGV4IT09LTEpe1xuICAgICAgICAgICAgTWVzc2FnZUJ1cy5fc3Vic2NyaWJlck1hcFtpZGVudGlmaWVyXS5zcGxpY2UoaW5kZXgsMSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIHBvc3QobWVzc2FnZTpNZXNzYWdlKTp2b2lke1xuICAgICAgICBsZXQgc3Vic2NyaWJlcnM9TWVzc2FnZUJ1cy5fc3Vic2NyaWJlck1hcFttZXNzYWdlLmlkZW50aWZpZXJdO1xuICAgICAgICBpZihzdWJzY3JpYmVycz09PXVuZGVmaW5lZCl7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1lc3NhZ2UgXCIrbWVzc2FnZStcIiBub3QgcG9zdGVkOiBObyBzdWJzY3JpYmVycyBcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBmb3IobGV0IHMgb2Ygc3Vic2NyaWJlcnMpe1xuICAgICAgICAgICAgaWYobWVzc2FnZS5wcmlvcml0eT09TWVzc2FnZVByaW9yaXR5LkhJR0gpe1xuICAgICAgICAgICAgICAgIHMucmVjZWl2ZU1lc3NhZ2UobWVzc2FnZSk7XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICBNZXNzYWdlQnVzLl9tZXNzYWdlUXVldWUucHVzaChtZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIHVwZGF0ZSgpOnZvaWR7XG4gICAgICAgIGlmKE1lc3NhZ2VCdXMuX21lc3NhZ2VRdWV1ZS5sZW5ndGg9PT0wKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBtZXNzYWdlTGltaXQ9TWF0aC5taW4oTWVzc2FnZUJ1cy5fbm9ybWFsTWVzc2FnZUNhcGFjaXR5LE1lc3NhZ2VCdXMuX21lc3NhZ2VRdWV1ZS5sZW5ndGgpO1xuICAgICAgICBmb3IobGV0IGk9MDtpPG1lc3NhZ2VMaW1pdDtpKyspe1xuICAgICAgICAgICAgbGV0IG1lc3NhZ2U9TWVzc2FnZUJ1cy5fbWVzc2FnZVF1ZXVlLnBvcCgpO1xuICAgICAgICAgICAgZm9yKGxldCBzIG9mIHRoaXMuX3N1YnNjcmliZXJNYXBbbWVzc2FnZS5pZGVudGlmaWVyXSl7XG4gICAgICAgICAgICAgICAgcy5yZWNlaXZlTWVzc2FnZShtZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIH1cbiAgICB9XG5cblxuXG59XG4iLCJleHBvcnQgZGVmYXVsdCBcIiN2ZXJzaW9uIDMwMCBlc1xcbiBcXG4vLyBhbiBhdHRyaWJ1dGUgaXMgYW4gaW5wdXQgKGluKSB0byBhIHZlcnRleCBzaGFkZXIuXFxuLy8gSXQgd2lsbCByZWNlaXZlIGRhdGEgZnJvbSBhIGJ1ZmZlclxcbmluIHZlYzQgYV9wb3NpdGlvbjtcXG5cXG51bmlmb3JtIG1hdDQgdV9wcm9qZWN0aW9uO1xcbnVuaWZvcm0gbWF0NCB1X3RyYW5zbGF0aW9uO1xcblxcbi8vIGFsbCBzaGFkZXJzIGhhdmUgYSBtYWluIGZ1bmN0aW9uXFxudm9pZCBtYWluKCkge1xcblxcbiAgLy8gZ2xfUG9zaXRpb24gaXMgYSBzcGVjaWFsIHZhcmlhYmxlIGEgdmVydGV4IHNoYWRlclxcbiAgLy8gaXMgcmVzcG9uc2libGUgZm9yIHNldHRpbmdcXG4gIGdsX1Bvc2l0aW9uID0gYV9wb3NpdGlvbjtcXG59XFxuXCI7IiwiZXhwb3J0IGRlZmF1bHQgXCIjdmVyc2lvbiAzMDAgZXNcXG4gXFxuLy8gZnJhZ21lbnQgc2hhZGVycyBkb24ndCBoYXZlIGEgZGVmYXVsdCBwcmVjaXNpb24gc28gd2UgbmVlZFxcbi8vIHRvIHBpY2sgb25lLiBoaWdocCBpcyBhIGdvb2QgZGVmYXVsdC4gSXQgbWVhbnMgXFxcImhpZ2ggcHJlY2lzaW9uXFxcIlxcbnByZWNpc2lvbiBoaWdocCBmbG9hdDtcXG4gXFxuLy8gd2UgbmVlZCB0byBkZWNsYXJlIGFuIG91dHB1dCBmb3IgdGhlIGZyYWdtZW50IHNoYWRlclxcbm91dCB2ZWM0IG91dENvbG9yO1xcbiBcXG52b2lkIG1haW4oKSB7XFxuICAvLyBKdXN0IHNldCB0aGUgb3V0cHV0IHRvIGEgY29uc3RhbnQgcmVkZGlzaC1wdXJwbGVcXG4gIG91dENvbG9yID0gdmVjNCgxLCAwLCAwLjUsIDEpO1xcbn1cXG5cIjsiLCJpbXBvcnQgUmVuZGVyZXIgZnJvbSBcIi4vcmVuZGVyZXIvcmVuZGVyZXJcIjtcbmltcG9ydCB7IElNZXNzYWdlU3Vic2NyaWJlciB9IGZyb20gXCIuL21lc3NhZ2UvSU1lc3NhZ2VTdWJzY3JpYmVyXCI7XG5pbXBvcnQgeyBNZXNzYWdlIH0gZnJvbSBcIi4vbWVzc2FnZS9tZXNzYWdlXCI7XG5pbXBvcnQgeyBNZXNzYWdlQnVzIH0gZnJvbSBcIi4vbWVzc2FnZS9tZXNzYWdlQnVzXCI7XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW5wdXRIYW5kbGVyIGltcGxlbWVudHMgSU1lc3NhZ2VTdWJzY3JpYmVye1xuICAgIHRhcmdldEVsZW1lbnQ6IEhUTUxDYW52YXNFbGVtZW50O1xuICAgIHJlbmRlcmVyOiBSZW5kZXJlcjtcblxuICAgIGNvbnN0cnVjdG9yKHRhcmdldDpIVE1MQ2FudmFzRWxlbWVudCwgcmVuZDpSZW5kZXJlcil7XG4gICAgICAgIHRoaXMudGFyZ2V0RWxlbWVudD10YXJnZXQ7XG4gICAgICAgIHRoaXMucmVuZGVyZXI9cmVuZDtcbiAgICB9XG4gICAgcmVjZWl2ZU1lc3NhZ2UobWVzc2FnZTogTWVzc2FnZSk6IHZvaWQge1xuICAgIH1cblxuICAgIHVwZGF0ZSgpOnZvaWR7XG4gICAgICAgIFxuICAgIH1cblxuICAgIG9uS2V5RG93bihldmVudDpLZXlib2FyZEV2ZW50KTp2b2lke1xuICAgICAgICBpZihldmVudC5rZXk9PT1cIkFycm93VXBcIil7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVQIVwiKTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgXG5cbiAgICBwdWJsaWMgaW5pdElucHV0RXZlbnRzKCk6dm9pZHtcblxuXHRcdFxuXG5cdFx0dGhpcy50YXJnZXRFbGVtZW50Lm9ubW91c2Vtb3ZlPWV2ZW50ID0+e1xuXHRcdFx0Ly9jb25zb2xlLmxvZyhcImhpXCIpO1xuXHRcdH1cblxuXHRcdHRoaXMudGFyZ2V0RWxlbWVudC5vbm1vdXNlZG93bj1ldmVudD0+e1xuXHRcdFx0Y29uc29sZS5sb2coXCJYOlwiK2V2ZW50LnBhZ2VYK1wiIFk6XCIrZXZlbnQucGFnZVkpO1xuICAgICAgICAgICAgTWVzc2FnZUJ1cy5wb3N0KG5ldyBNZXNzYWdlKFwiQ0xJQ0tcIix0aGlzKSk7XG5cdFx0fVxuXHR9XG5cbn0iLCJpbXBvcnQgUmVuZGVyZXIgZnJvbSBcIi4vcmVuZGVyZXIvcmVuZGVyZXJcIjtcbmltcG9ydCBJbnB1dEhhbmRsZXIgZnJvbSBcIi4vaW5wdXRcIjtcbmltcG9ydCB7IE1lc3NhZ2VCdXMgfSBmcm9tIFwiLi9tZXNzYWdlL21lc3NhZ2VCdXNcIjtcblxudmFyIGNhbnZhc0lEID0gXCJ2ZXJ0aWdvQ2FudmFzXCI7XG5cbmV4cG9ydCBjbGFzcyBFbmdpbmUge1xuXG5cdHByaXZhdGUgX2NhbnZhczpIVE1MQ2FudmFzRWxlbWVudDtcblx0cHJpdmF0ZSBfcmVuZGVyZXI6UmVuZGVyZXI7XG5cblx0Y29uc3RydWN0b3IoY2FudmFzSUQ6c3RyaW5nPVwidmVydGlnb0NhbnZhc1wiKXtcblx0XHR0aGlzLl9jYW52YXMgPSA8SFRNTENhbnZhc0VsZW1lbnQ+KFxuXHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY2FudmFzSUQpXG5cdFx0KTtcblx0XHRpZiAodGhpcy5fY2FudmFzID09PSB1bmRlZmluZWQpXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXG5cdFx0XHRcdFwiRkFUQUw6IENhbm5vdCBmaW5kIGRlc3RpbmF0aW9uIGNhbnZhcyBlbGVtZW50IHdpdGggbmFtZTpcIiArIGNhbnZhc0lEXG5cdFx0XHQpO1xuXHR9XG5cblx0aW5pdGlhbGl6ZSgpIHtcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIgPSBuZXcgUmVuZGVyZXIodGhpcy5fY2FudmFzKTtcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIuaW5pdCgpO1xuXG5cdFx0bGV0IGlucHV0SGFuZGxlcj1uZXcgSW5wdXRIYW5kbGVyKHRoaXMuX2NhbnZhcyx0aGlzLl9yZW5kZXJlcik7XG5cdFx0aW5wdXRIYW5kbGVyLmluaXRJbnB1dEV2ZW50cygpO1xuXHRcdHRoaXMucnVuKCk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgc3RhdGljIHNlbmRJbnB1dE1lc3NhZ2UobWVzc2FnZTpzdHJpbmcpOnZvaWR7XG5cdFx0XG5cdH1cblxuXHRwdWJsaWMgcnVuKCk6dm9pZHtcblxuXHRcdGNvbnN0IGdhbWVMb29wPSgpPT57XG5cdFx0XHRNZXNzYWdlQnVzLnVwZGF0ZSgpO1xuXG5cblx0XHRcdHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZ2FtZUxvb3ApO1xuXHRcdH07XG5cblx0XHR3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGdhbWVMb29wKTtcblxuXHR9XG5cbiAgICBcbn1cbiIsImltcG9ydCB7RW5naW5lfSBmcm9tICcuL2VuZ2luZSc7XG5cbndpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IGFwcGxpY2F0aW9uID0gbmV3IEVuZ2luZSgpO1xuICAgIGFwcGxpY2F0aW9uLmluaXRpYWxpemUoKTtcbiAgfTtcbiJdLCJuYW1lcyI6WyJNZXNzYWdlUHJpb3JpdHkiLCJnbCIsIl9jYW52YXMiLCJpZGVudGlmaWVyIiwic2VuZGVyIiwicGF5bG9hZCIsInByaW9yaXR5IiwiTk9STUFMIiwidGhpcyIsImFkZFN1YnNjcmlwdGlvbiIsInN1YnNjcmliZXIiLCJjdXJyZW50IiwiTWVzc2FnZUJ1cyIsIl9zdWJzY3JpYmVyTWFwIiwidW5kZWZpbmVkIiwiaW5kZXhPZiIsImNvbnNvbGUiLCJ3YXJuIiwicHVzaCIsInJlbW92ZVN1YnNjcmlwdGlvbiIsImluZGV4Iiwic3BsaWNlIiwicG9zdCIsIm1lc3NhZ2UiLCJzdWJzY3JpYmVycyIsInMiLCJISUdIIiwicmVjZWl2ZU1lc3NhZ2UiLCJfbWVzc2FnZVF1ZXVlIiwibG9nIiwidXBkYXRlIiwibGVuZ3RoIiwibWVzc2FnZUxpbWl0IiwiTWF0aCIsIm1pbiIsIl9ub3JtYWxNZXNzYWdlQ2FwYWNpdHkiLCJpIiwicG9wIiwidGFyZ2V0IiwiRXJyb3IiLCJnZXRDb250ZXh0IiwiaW5pdCIsInZlcnQiLCJSZW5kZXJlciIsImNyZWF0ZVNoYWRlciIsIlZFUlRFWF9TSEFERVIiLCJmcmFnIiwiRlJBR01FTlRfU0hBREVSIiwicHJvZ3JhbSIsImNyZWF0ZVByb2dyYW0iLCJ1c2VQcm9ncmFtIiwicG9zaXRpb25BdHRyaWJ1dGVMb2NhdGlvbiIsImdldEF0dHJpYkxvY2F0aW9uIiwicG9zaXRpb25CdWZmZXIiLCJjcmVhdGVCdWZmZXIiLCJiaW5kQnVmZmVyIiwiQVJSQVlfQlVGRkVSIiwiYnVmZmVyRGF0YSIsIkZsb2F0MzJBcnJheSIsIlNUQVRJQ19EUkFXIiwidmFvIiwiY3JlYXRlVmVydGV4QXJyYXkiLCJiaW5kVmVydGV4QXJyYXkiLCJlbmFibGVWZXJ0ZXhBdHRyaWJBcnJheSIsInR5cGUiLCJGTE9BVCIsIm9mZnNldCIsInZlcnRleEF0dHJpYlBvaW50ZXIiLCJyZXNpemVDYW52YXNUb0Rpc3BsYXlTaXplIiwidmlld3BvcnQiLCJjYW52YXMiLCJ3aWR0aCIsImhlaWdodCIsImNsZWFyQ29sb3IiLCJjbGVhciIsIkNPTE9SX0JVRkZFUl9CSVQiLCJwcmltaXRpdmVUeXBlIiwiVFJJQU5HTEVTIiwiZHJhd0FycmF5cyIsInNvdXJjZSIsInNoYWRlciIsInNoYWRlclNvdXJjZSIsImNvbXBpbGVTaGFkZXIiLCJnZXRTaGFkZXJQYXJhbWV0ZXIiLCJDT01QSUxFX1NUQVRVUyIsImdldFNoYWRlckluZm9Mb2ciLCJkZWxldGVTaGFkZXIiLCJ2ZXJ0ZXhTaGFkZXIiLCJmcmFnbWVudFNoYWRlciIsImF0dGFjaFNoYWRlciIsImxpbmtQcm9ncmFtIiwiZ2V0UHJvZ3JhbVBhcmFtZXRlciIsIkxJTktfU1RBVFVTIiwiZ2V0UHJvZ3JhbUluZm9Mb2ciLCJkZWxldGVQcm9ncmFtIiwiZGlzcGxheVdpZHRoIiwiY2xpZW50V2lkdGgiLCJkaXNwbGF5SGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwicmVuZCIsInRhcmdldEVsZW1lbnQiLCJyZW5kZXJlciIsIm9uS2V5RG93biIsImV2ZW50Iiwia2V5IiwiaW5pdElucHV0RXZlbnRzIiwib25tb3VzZW1vdmUiLCJvbm1vdXNlZG93biIsInBhZ2VYIiwicGFnZVkiLCJNZXNzYWdlIiwiY2FudmFzSUQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaW5pdGlhbGl6ZSIsIl9yZW5kZXJlciIsInJ1biIsInNlbmRJbnB1dE1lc3NhZ2UiLCJnYW1lTG9vcCIsIndpbmRvdyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm9ubG9hZCIsIkVuZ2luZSJdLCJzb3VyY2VSb290IjoiIn0=